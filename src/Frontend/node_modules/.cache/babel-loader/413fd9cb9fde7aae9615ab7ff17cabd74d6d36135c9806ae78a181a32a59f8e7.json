{"ast":null,"code":"\"use strict\";\n\n// Copyright 2014 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*!\n * @module common/util\n */\nconst projectify_1 = require(\"@google-cloud/projectify\");\nconst ent = require(\"ent\");\nconst extend = require(\"extend\");\nconst google_auth_library_1 = require(\"google-auth-library\");\nconst retryRequest = require(\"retry-request\");\nconst stream_1 = require(\"stream\");\nconst teeny_request_1 = require(\"teeny-request\");\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst duplexify = require('duplexify');\nconst requestDefaults = {\n  timeout: 60000,\n  gzip: true,\n  forever: true,\n  pool: {\n    maxSockets: Infinity\n  }\n};\n/**\n * Default behavior: Automatically retry retriable server errors.\n *\n * @const {boolean}\n * @private\n */\nconst AUTO_RETRY_DEFAULT = true;\n/**\n * Default behavior: Only attempt to retry retriable errors 3 times.\n *\n * @const {number}\n * @private\n */\nconst MAX_RETRY_DEFAULT = 3;\n/**\n * Custom error type for API errors.\n *\n * @param {object} errorBody - Error object.\n */\nclass ApiError extends Error {\n  constructor(errorBodyOrMessage) {\n    super();\n    if (typeof errorBodyOrMessage !== 'object') {\n      this.message = errorBodyOrMessage || '';\n      return;\n    }\n    const errorBody = errorBodyOrMessage;\n    this.code = errorBody.code;\n    this.errors = errorBody.errors;\n    this.response = errorBody.response;\n    try {\n      this.errors = JSON.parse(this.response.body).error.errors;\n    } catch (e) {\n      this.errors = errorBody.errors;\n    }\n    this.message = ApiError.createMultiErrorMessage(errorBody, this.errors);\n    Error.captureStackTrace(this);\n  }\n  /**\n   * Pieces together an error message by combining all unique error messages\n   * returned from a single GoogleError\n   *\n   * @private\n   *\n   * @param {GoogleErrorBody} err The original error.\n   * @param {GoogleInnerError[]} [errors] Inner errors, if any.\n   * @returns {string}\n   */\n  static createMultiErrorMessage(err, errors) {\n    const messages = new Set();\n    if (err.message) {\n      messages.add(err.message);\n    }\n    if (errors && errors.length) {\n      errors.forEach(({\n        message\n      }) => messages.add(message));\n    } else if (err.response && err.response.body) {\n      messages.add(ent.decode(err.response.body.toString()));\n    } else if (!err.message) {\n      messages.add('A failure occurred during this request.');\n    }\n    let messageArr = Array.from(messages);\n    if (messageArr.length > 1) {\n      messageArr = messageArr.map((message, i) => `    ${i + 1}. ${message}`);\n      messageArr.unshift('Multiple errors occurred during the request. Please see the `errors` array for complete details.\\n');\n      messageArr.push('\\n');\n    }\n    return messageArr.join('\\n');\n  }\n}\nexports.ApiError = ApiError;\n/**\n * Custom error type for partial errors returned from the API.\n *\n * @param {object} b - Error object.\n */\nclass PartialFailureError extends Error {\n  constructor(b) {\n    super();\n    const errorObject = b;\n    this.errors = errorObject.errors;\n    this.name = 'PartialFailureError';\n    this.response = errorObject.response;\n    this.message = ApiError.createMultiErrorMessage(errorObject, this.errors);\n  }\n}\nexports.PartialFailureError = PartialFailureError;\nclass Util {\n  constructor() {\n    this.ApiError = ApiError;\n    this.PartialFailureError = PartialFailureError;\n  }\n  /**\n   * No op.\n   *\n   * @example\n   * function doSomething(callback) {\n   *   callback = callback || noop;\n   * }\n   */\n  noop() {}\n  /**\n   * Uniformly process an API response.\n   *\n   * @param {*} err - Error value.\n   * @param {*} resp - Response value.\n   * @param {*} body - Body value.\n   * @param {function} callback - The callback function.\n   */\n  handleResp(err, resp, body, callback) {\n    callback = callback || util.noop;\n    const parsedResp = extend(true, {\n      err: err || null\n    }, resp && util.parseHttpRespMessage(resp), body && util.parseHttpRespBody(body));\n    // Assign the parsed body to resp.body, even if { json: false } was passed\n    // as a request option.\n    // We assume that nobody uses the previously unparsed value of resp.body.\n    if (!parsedResp.err && resp && typeof parsedResp.body === 'object') {\n      parsedResp.resp.body = parsedResp.body;\n    }\n    if (parsedResp.err && resp) {\n      parsedResp.err.response = resp;\n    }\n    callback(parsedResp.err, parsedResp.body, parsedResp.resp);\n  }\n  /**\n   * Sniff an incoming HTTP response message for errors.\n   *\n   * @param {object} httpRespMessage - An incoming HTTP response message from `request`.\n   * @return {object} parsedHttpRespMessage - The parsed response.\n   * @param {?error} parsedHttpRespMessage.err - An error detected.\n   * @param {object} parsedHttpRespMessage.resp - The original response object.\n   */\n  parseHttpRespMessage(httpRespMessage) {\n    const parsedHttpRespMessage = {\n      resp: httpRespMessage\n    };\n    if (httpRespMessage.statusCode < 200 || httpRespMessage.statusCode > 299) {\n      // Unknown error. Format according to ApiError standard.\n      parsedHttpRespMessage.err = new ApiError({\n        errors: new Array(),\n        code: httpRespMessage.statusCode,\n        message: httpRespMessage.statusMessage,\n        response: httpRespMessage\n      });\n    }\n    return parsedHttpRespMessage;\n  }\n  /**\n   * Parse the response body from an HTTP request.\n   *\n   * @param {object} body - The response body.\n   * @return {object} parsedHttpRespMessage - The parsed response.\n   * @param {?error} parsedHttpRespMessage.err - An error detected.\n   * @param {object} parsedHttpRespMessage.body - The original body value provided\n   *     will try to be JSON.parse'd. If it's successful, the parsed value will\n   * be returned here, otherwise the original value and an error will be returned.\n   */\n  parseHttpRespBody(body) {\n    const parsedHttpRespBody = {\n      body\n    };\n    if (typeof body === 'string') {\n      try {\n        parsedHttpRespBody.body = JSON.parse(body);\n      } catch (err) {\n        parsedHttpRespBody.body = body;\n      }\n    }\n    if (parsedHttpRespBody.body && parsedHttpRespBody.body.error) {\n      // Error from JSON API.\n      parsedHttpRespBody.err = new ApiError(parsedHttpRespBody.body.error);\n    }\n    return parsedHttpRespBody;\n  }\n  /**\n   * Take a Duplexify stream, fetch an authenticated connection header, and\n   * create an outgoing writable stream.\n   *\n   * @param {Duplexify} dup - Duplexify stream.\n   * @param {object} options - Configuration object.\n   * @param {module:common/connection} options.connection - A connection instance used to get a token with and send the request through.\n   * @param {object} options.metadata - Metadata to send at the head of the request.\n   * @param {object} options.request - Request object, in the format of a standard Node.js http.request() object.\n   * @param {string=} options.request.method - Default: \"POST\".\n   * @param {string=} options.request.qs.uploadType - Default: \"multipart\".\n   * @param {string=} options.streamContentType - Default: \"application/octet-stream\".\n   * @param {function} onComplete - Callback, executed after the writable Request stream has completed.\n   */\n  makeWritableStream(dup, options, onComplete) {\n    onComplete = onComplete || util.noop;\n    const writeStream = new ProgressStream();\n    writeStream.on('progress', evt => dup.emit('progress', evt));\n    dup.setWritable(writeStream);\n    const defaultReqOpts = {\n      method: 'POST',\n      qs: {\n        uploadType: 'multipart'\n      },\n      timeout: 0,\n      maxRetries: 0\n    };\n    const metadata = options.metadata || {};\n    const reqOpts = extend(true, defaultReqOpts, options.request, {\n      multipart: [{\n        'Content-Type': 'application/json',\n        body: JSON.stringify(metadata)\n      }, {\n        'Content-Type': metadata.contentType || 'application/octet-stream',\n        body: writeStream\n      }]\n    });\n    options.makeAuthenticatedRequest(reqOpts, {\n      onAuthenticated(err, authenticatedReqOpts) {\n        if (err) {\n          dup.destroy(err);\n          return;\n        }\n        const request = teeny_request_1.teenyRequest.defaults(requestDefaults);\n        request(authenticatedReqOpts, (err, resp, body) => {\n          util.handleResp(err, resp, body, (err, data) => {\n            if (err) {\n              dup.destroy(err);\n              return;\n            }\n            dup.emit('response', resp);\n            onComplete(data);\n          });\n        });\n      }\n    });\n  }\n  /**\n   * Returns true if the API request should be retried, given the error that was\n   * given the first time the request was attempted. This is used for rate limit\n   * related errors as well as intermittent server errors.\n   *\n   * @param {error} err - The API error to check if it is appropriate to retry.\n   * @return {boolean} True if the API request should be retried, false otherwise.\n   */\n  shouldRetryRequest(err) {\n    if (err) {\n      if ([408, 429, 500, 502, 503, 504].indexOf(err.code) !== -1) {\n        return true;\n      }\n      if (err.errors) {\n        for (const e of err.errors) {\n          const reason = e.reason;\n          if (reason === 'rateLimitExceeded') {\n            return true;\n          }\n          if (reason === 'userRateLimitExceeded') {\n            return true;\n          }\n          if (reason && reason.includes('EAI_AGAIN')) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  }\n  /**\n   * Get a function for making authenticated requests.\n   *\n   * @param {object} config - Configuration object.\n   * @param {boolean=} config.autoRetry - Automatically retry requests if the\n   *     response is related to rate limits or certain intermittent server\n   * errors. We will exponentially backoff subsequent requests by default.\n   * (default: true)\n   * @param {object=} config.credentials - Credentials object.\n   * @param {boolean=} config.customEndpoint - If true, just return the provided request options. Default: false.\n   * @param {boolean=} config.useAuthWithCustomEndpoint - If true, will authenticate when using a custom endpoint. Default: false.\n   * @param {string=} config.email - Account email address, required for PEM/P12 usage.\n   * @param {number=} config.maxRetries - Maximum number of automatic retries attempted before returning the error. (default: 3)\n   * @param {string=} config.keyFile - Path to a .json, .pem, or .p12 keyfile.\n   * @param {array} config.scopes - Array of scopes required for the API.\n   */\n  makeAuthenticatedRequestFactory(config) {\n    const googleAutoAuthConfig = extend({}, config);\n    if (googleAutoAuthConfig.projectId === '{{projectId}}') {\n      delete googleAutoAuthConfig.projectId;\n    }\n    let authClient;\n    if (googleAutoAuthConfig.authClient instanceof google_auth_library_1.GoogleAuth) {\n      // Use an existing `GoogleAuth`\n      authClient = googleAutoAuthConfig.authClient;\n    } else {\n      // Pass an `AuthClient` to `GoogleAuth`, if available\n      const config = {\n        ...googleAutoAuthConfig,\n        authClient: googleAutoAuthConfig.authClient\n      };\n      authClient = new google_auth_library_1.GoogleAuth(config);\n    }\n    function makeAuthenticatedRequest(reqOpts, optionsOrCallback) {\n      let stream;\n      let projectId;\n      const reqConfig = extend({}, config);\n      let activeRequest_;\n      if (!optionsOrCallback) {\n        stream = duplexify();\n        reqConfig.stream = stream;\n      }\n      const options = typeof optionsOrCallback === 'object' ? optionsOrCallback : undefined;\n      const callback = typeof optionsOrCallback === 'function' ? optionsOrCallback : undefined;\n      const onAuthenticated = (err, authenticatedReqOpts) => {\n        const authLibraryError = err;\n        const autoAuthFailed = err && err.message.indexOf('Could not load the default credentials') > -1;\n        if (autoAuthFailed) {\n          // Even though authentication failed, the API might not actually\n          // care.\n          authenticatedReqOpts = reqOpts;\n        }\n        if (!err || autoAuthFailed) {\n          try {\n            authenticatedReqOpts = util.decorateRequest(authenticatedReqOpts, projectId);\n            err = null;\n          } catch (e) {\n            // A projectId was required, but we don't have one.\n            // Re-use the \"Could not load the default credentials error\" if\n            // auto auth failed.\n            err = err || e;\n          }\n        }\n        if (err) {\n          if (stream) {\n            stream.destroy(err);\n          } else {\n            const fn = options && options.onAuthenticated ? options.onAuthenticated : callback;\n            fn(err);\n          }\n          return;\n        }\n        if (options && options.onAuthenticated) {\n          options.onAuthenticated(null, authenticatedReqOpts);\n        } else {\n          activeRequest_ = util.makeRequest(authenticatedReqOpts, reqConfig, (apiResponseError, ...params) => {\n            if (apiResponseError && apiResponseError.code === 401 && authLibraryError) {\n              // Re-use the \"Could not load the default credentials error\" if\n              // the API request failed due to missing credentials.\n              apiResponseError = authLibraryError;\n            }\n            callback(apiResponseError, ...params);\n          });\n        }\n      };\n      Promise.all([config.projectId && config.projectId !== '{{projectId}}' ?\n      // The user provided a project ID. We don't need to check with the\n      // auth client, it could be incorrect.\n      new Promise(resolve => resolve(config.projectId)) : authClient.getProjectId(), reqConfig.customEndpoint && reqConfig.useAuthWithCustomEndpoint !== true ?\n      // Using a custom API override. Do not use `google-auth-library` for\n      // authentication. (ex: connecting to a local Datastore server)\n      new Promise(resolve => resolve(reqOpts)) : authClient.authorizeRequest(reqOpts)]).then(([_projectId, authorizedReqOpts]) => {\n        projectId = _projectId;\n        onAuthenticated(null, authorizedReqOpts);\n      }).catch(onAuthenticated);\n      if (stream) {\n        return stream;\n      }\n      return {\n        abort() {\n          setImmediate(() => {\n            if (activeRequest_) {\n              activeRequest_.abort();\n              activeRequest_ = null;\n            }\n          });\n        }\n      };\n    }\n    const mar = makeAuthenticatedRequest;\n    mar.getCredentials = authClient.getCredentials.bind(authClient);\n    mar.authClient = authClient;\n    return mar;\n  }\n  /**\n   * Make a request through the `retryRequest` module with built-in error\n   * handling and exponential back off.\n   *\n   * @param {object} reqOpts - Request options in the format `request` expects.\n   * @param {object=} config - Configuration object.\n   * @param {boolean=} config.autoRetry - Automatically retry requests if the\n   *     response is related to rate limits or certain intermittent server\n   * errors. We will exponentially backoff subsequent requests by default.\n   * (default: true)\n   * @param {number=} config.maxRetries - Maximum number of automatic retries\n   *     attempted before returning the error. (default: 3)\n   * @param {object=} config.request - HTTP module for request calls.\n   * @param {function} callback - The callback function.\n   */\n  makeRequest(reqOpts, config, callback) {\n    var _a, _b, _c, _d, _e, _f, _g;\n    let autoRetryValue = AUTO_RETRY_DEFAULT;\n    if (config.autoRetry !== undefined && ((_a = config.retryOptions) === null || _a === void 0 ? void 0 : _a.autoRetry) !== undefined) {\n      throw new ApiError('autoRetry is deprecated. Use retryOptions.autoRetry instead.');\n    } else if (config.autoRetry !== undefined) {\n      autoRetryValue = config.autoRetry;\n    } else if (((_b = config.retryOptions) === null || _b === void 0 ? void 0 : _b.autoRetry) !== undefined) {\n      autoRetryValue = config.retryOptions.autoRetry;\n    }\n    let maxRetryValue = MAX_RETRY_DEFAULT;\n    if (config.maxRetries && ((_c = config.retryOptions) === null || _c === void 0 ? void 0 : _c.maxRetries)) {\n      throw new ApiError('maxRetries is deprecated. Use retryOptions.maxRetries instead.');\n    } else if (config.maxRetries) {\n      maxRetryValue = config.maxRetries;\n    } else if ((_d = config.retryOptions) === null || _d === void 0 ? void 0 : _d.maxRetries) {\n      maxRetryValue = config.retryOptions.maxRetries;\n    }\n    const options = {\n      request: teeny_request_1.teenyRequest.defaults(requestDefaults),\n      retries: autoRetryValue !== false ? maxRetryValue : 0,\n      noResponseRetries: autoRetryValue !== false ? maxRetryValue : 0,\n      shouldRetryFn(httpRespMessage) {\n        var _a, _b;\n        const err = util.parseHttpRespMessage(httpRespMessage).err;\n        if ((_a = config.retryOptions) === null || _a === void 0 ? void 0 : _a.retryableErrorFn) {\n          return err && ((_b = config.retryOptions) === null || _b === void 0 ? void 0 : _b.retryableErrorFn(err));\n        }\n        return err && util.shouldRetryRequest(err);\n      },\n      maxRetryDelay: (_e = config.retryOptions) === null || _e === void 0 ? void 0 : _e.maxRetryDelay,\n      retryDelayMultiplier: (_f = config.retryOptions) === null || _f === void 0 ? void 0 : _f.retryDelayMultiplier,\n      totalTimeout: (_g = config.retryOptions) === null || _g === void 0 ? void 0 : _g.totalTimeout\n    };\n    if (typeof reqOpts.maxRetries === 'number') {\n      options.retries = reqOpts.maxRetries;\n    }\n    if (!config.stream) {\n      return retryRequest(reqOpts, options, (err, response, body) => {\n        util.handleResp(err, response, body, callback);\n      });\n    }\n    const dup = config.stream;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    let requestStream;\n    const isGetRequest = (reqOpts.method || 'GET').toUpperCase() === 'GET';\n    if (isGetRequest) {\n      requestStream = retryRequest(reqOpts, options);\n      dup.setReadable(requestStream);\n    } else {\n      // Streaming writable HTTP requests cannot be retried.\n      requestStream = options.request(reqOpts);\n      dup.setWritable(requestStream);\n    }\n    // Replay the Request events back to the stream.\n    requestStream.on('error', dup.destroy.bind(dup)).on('response', dup.emit.bind(dup, 'response')).on('complete', dup.emit.bind(dup, 'complete'));\n    dup.abort = requestStream.abort;\n    return dup;\n  }\n  /**\n   * Decorate the options about to be made in a request.\n   *\n   * @param {object} reqOpts - The options to be passed to `request`.\n   * @param {string} projectId - The project ID.\n   * @return {object} reqOpts - The decorated reqOpts.\n   */\n  decorateRequest(reqOpts, projectId) {\n    delete reqOpts.autoPaginate;\n    delete reqOpts.autoPaginateVal;\n    delete reqOpts.objectMode;\n    if (reqOpts.qs !== null && typeof reqOpts.qs === 'object') {\n      delete reqOpts.qs.autoPaginate;\n      delete reqOpts.qs.autoPaginateVal;\n      reqOpts.qs = projectify_1.replaceProjectIdToken(reqOpts.qs, projectId);\n    }\n    if (Array.isArray(reqOpts.multipart)) {\n      reqOpts.multipart = reqOpts.multipart.map(part => {\n        return projectify_1.replaceProjectIdToken(part, projectId);\n      });\n    }\n    if (reqOpts.json !== null && typeof reqOpts.json === 'object') {\n      delete reqOpts.json.autoPaginate;\n      delete reqOpts.json.autoPaginateVal;\n      reqOpts.json = projectify_1.replaceProjectIdToken(reqOpts.json, projectId);\n    }\n    reqOpts.uri = projectify_1.replaceProjectIdToken(reqOpts.uri, projectId);\n    return reqOpts;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  isCustomType(unknown, module) {\n    function getConstructorName(obj) {\n      return obj.constructor && obj.constructor.name.toLowerCase();\n    }\n    const moduleNameParts = module.split('/');\n    const parentModuleName = moduleNameParts[0] && moduleNameParts[0].toLowerCase();\n    const subModuleName = moduleNameParts[1] && moduleNameParts[1].toLowerCase();\n    if (subModuleName && getConstructorName(unknown) !== subModuleName) {\n      return false;\n    }\n    let walkingModule = unknown;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      if (getConstructorName(walkingModule) === parentModuleName) {\n        return true;\n      }\n      walkingModule = walkingModule.parent;\n      if (!walkingModule) {\n        return false;\n      }\n    }\n  }\n  /**\n   * Create a properly-formatted User-Agent string from a package.json file.\n   *\n   * @param {object} packageJson - A module's package.json file.\n   * @return {string} userAgent - The formatted User-Agent string.\n   */\n  getUserAgentFromPackageJson(packageJson) {\n    const hyphenatedPackageName = packageJson.name.replace('@google-cloud', 'gcloud-node') // For legacy purposes.\n    .replace('/', '-'); // For UA spec-compliance purposes.\n    return hyphenatedPackageName + '/' + packageJson.version;\n  }\n  /**\n   * Given two parameters, figure out if this is either:\n   *  - Just a callback function\n   *  - An options object, and then a callback function\n   * @param optionsOrCallback An options object or callback.\n   * @param cb A potentially undefined callback.\n   */\n  maybeOptionsOrCallback(optionsOrCallback, cb) {\n    return typeof optionsOrCallback === 'function' ? [{}, optionsOrCallback] : [optionsOrCallback, cb];\n  }\n}\nexports.Util = Util;\n/**\n * Basic Passthrough Stream that records the number of bytes read\n * every time the cursor is moved.\n */\nclass ProgressStream extends stream_1.Transform {\n  constructor() {\n    super(...arguments);\n    this.bytesRead = 0;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _transform(chunk, encoding, callback) {\n    this.bytesRead += chunk.length;\n    this.emit('progress', {\n      bytesWritten: this.bytesRead,\n      contentLength: '*'\n    });\n    this.push(chunk);\n    callback();\n  }\n}\nconst util = new Util();\nexports.util = util;","map":{"version":3,"names":["Object","defineProperty","exports","value","projectify_1","require","ent","extend","google_auth_library_1","retryRequest","stream_1","teeny_request_1","duplexify","requestDefaults","timeout","gzip","forever","pool","maxSockets","Infinity","AUTO_RETRY_DEFAULT","MAX_RETRY_DEFAULT","ApiError","Error","constructor","errorBodyOrMessage","message","errorBody","code","errors","response","JSON","parse","body","error","e","createMultiErrorMessage","captureStackTrace","err","messages","Set","add","length","forEach","decode","toString","messageArr","Array","from","map","i","unshift","push","join","PartialFailureError","b","errorObject","name","Util","noop","handleResp","resp","callback","util","parsedResp","parseHttpRespMessage","parseHttpRespBody","httpRespMessage","parsedHttpRespMessage","statusCode","statusMessage","parsedHttpRespBody","makeWritableStream","dup","options","onComplete","writeStream","ProgressStream","on","evt","emit","setWritable","defaultReqOpts","method","qs","uploadType","maxRetries","metadata","reqOpts","request","multipart","stringify","contentType","makeAuthenticatedRequest","onAuthenticated","authenticatedReqOpts","destroy","teenyRequest","defaults","data","shouldRetryRequest","indexOf","reason","includes","makeAuthenticatedRequestFactory","config","googleAutoAuthConfig","projectId","authClient","GoogleAuth","optionsOrCallback","stream","reqConfig","activeRequest_","undefined","authLibraryError","autoAuthFailed","decorateRequest","fn","makeRequest","apiResponseError","params","Promise","all","resolve","getProjectId","customEndpoint","useAuthWithCustomEndpoint","authorizeRequest","then","_projectId","authorizedReqOpts","catch","abort","setImmediate","mar","getCredentials","bind","_a","_b","_c","_d","_e","_f","_g","autoRetryValue","autoRetry","retryOptions","maxRetryValue","retries","noResponseRetries","shouldRetryFn","retryableErrorFn","maxRetryDelay","retryDelayMultiplier","totalTimeout","requestStream","isGetRequest","toUpperCase","setReadable","autoPaginate","autoPaginateVal","objectMode","replaceProjectIdToken","isArray","part","json","uri","isCustomType","unknown","module","getConstructorName","obj","toLowerCase","moduleNameParts","split","parentModuleName","subModuleName","walkingModule","parent","getUserAgentFromPackageJson","packageJson","hyphenatedPackageName","replace","version","maybeOptionsOrCallback","cb","Transform","arguments","bytesRead","_transform","chunk","encoding","bytesWritten","contentLength"],"sources":["C:/Users/ergas/OneDrive/Рабочий стол/inno/FoodFullstack/src/Frontend/node_modules/@google-cloud/common/build/src/util.js"],"sourcesContent":["\"use strict\";\n// Copyright 2014 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/*!\n * @module common/util\n */\nconst projectify_1 = require(\"@google-cloud/projectify\");\nconst ent = require(\"ent\");\nconst extend = require(\"extend\");\nconst google_auth_library_1 = require(\"google-auth-library\");\nconst retryRequest = require(\"retry-request\");\nconst stream_1 = require(\"stream\");\nconst teeny_request_1 = require(\"teeny-request\");\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst duplexify = require('duplexify');\nconst requestDefaults = {\n    timeout: 60000,\n    gzip: true,\n    forever: true,\n    pool: {\n        maxSockets: Infinity,\n    },\n};\n/**\n * Default behavior: Automatically retry retriable server errors.\n *\n * @const {boolean}\n * @private\n */\nconst AUTO_RETRY_DEFAULT = true;\n/**\n * Default behavior: Only attempt to retry retriable errors 3 times.\n *\n * @const {number}\n * @private\n */\nconst MAX_RETRY_DEFAULT = 3;\n/**\n * Custom error type for API errors.\n *\n * @param {object} errorBody - Error object.\n */\nclass ApiError extends Error {\n    constructor(errorBodyOrMessage) {\n        super();\n        if (typeof errorBodyOrMessage !== 'object') {\n            this.message = errorBodyOrMessage || '';\n            return;\n        }\n        const errorBody = errorBodyOrMessage;\n        this.code = errorBody.code;\n        this.errors = errorBody.errors;\n        this.response = errorBody.response;\n        try {\n            this.errors = JSON.parse(this.response.body).error.errors;\n        }\n        catch (e) {\n            this.errors = errorBody.errors;\n        }\n        this.message = ApiError.createMultiErrorMessage(errorBody, this.errors);\n        Error.captureStackTrace(this);\n    }\n    /**\n     * Pieces together an error message by combining all unique error messages\n     * returned from a single GoogleError\n     *\n     * @private\n     *\n     * @param {GoogleErrorBody} err The original error.\n     * @param {GoogleInnerError[]} [errors] Inner errors, if any.\n     * @returns {string}\n     */\n    static createMultiErrorMessage(err, errors) {\n        const messages = new Set();\n        if (err.message) {\n            messages.add(err.message);\n        }\n        if (errors && errors.length) {\n            errors.forEach(({ message }) => messages.add(message));\n        }\n        else if (err.response && err.response.body) {\n            messages.add(ent.decode(err.response.body.toString()));\n        }\n        else if (!err.message) {\n            messages.add('A failure occurred during this request.');\n        }\n        let messageArr = Array.from(messages);\n        if (messageArr.length > 1) {\n            messageArr = messageArr.map((message, i) => `    ${i + 1}. ${message}`);\n            messageArr.unshift('Multiple errors occurred during the request. Please see the `errors` array for complete details.\\n');\n            messageArr.push('\\n');\n        }\n        return messageArr.join('\\n');\n    }\n}\nexports.ApiError = ApiError;\n/**\n * Custom error type for partial errors returned from the API.\n *\n * @param {object} b - Error object.\n */\nclass PartialFailureError extends Error {\n    constructor(b) {\n        super();\n        const errorObject = b;\n        this.errors = errorObject.errors;\n        this.name = 'PartialFailureError';\n        this.response = errorObject.response;\n        this.message = ApiError.createMultiErrorMessage(errorObject, this.errors);\n    }\n}\nexports.PartialFailureError = PartialFailureError;\nclass Util {\n    constructor() {\n        this.ApiError = ApiError;\n        this.PartialFailureError = PartialFailureError;\n    }\n    /**\n     * No op.\n     *\n     * @example\n     * function doSomething(callback) {\n     *   callback = callback || noop;\n     * }\n     */\n    noop() { }\n    /**\n     * Uniformly process an API response.\n     *\n     * @param {*} err - Error value.\n     * @param {*} resp - Response value.\n     * @param {*} body - Body value.\n     * @param {function} callback - The callback function.\n     */\n    handleResp(err, resp, body, callback) {\n        callback = callback || util.noop;\n        const parsedResp = extend(true, { err: err || null }, resp && util.parseHttpRespMessage(resp), body && util.parseHttpRespBody(body));\n        // Assign the parsed body to resp.body, even if { json: false } was passed\n        // as a request option.\n        // We assume that nobody uses the previously unparsed value of resp.body.\n        if (!parsedResp.err && resp && typeof parsedResp.body === 'object') {\n            parsedResp.resp.body = parsedResp.body;\n        }\n        if (parsedResp.err && resp) {\n            parsedResp.err.response = resp;\n        }\n        callback(parsedResp.err, parsedResp.body, parsedResp.resp);\n    }\n    /**\n     * Sniff an incoming HTTP response message for errors.\n     *\n     * @param {object} httpRespMessage - An incoming HTTP response message from `request`.\n     * @return {object} parsedHttpRespMessage - The parsed response.\n     * @param {?error} parsedHttpRespMessage.err - An error detected.\n     * @param {object} parsedHttpRespMessage.resp - The original response object.\n     */\n    parseHttpRespMessage(httpRespMessage) {\n        const parsedHttpRespMessage = {\n            resp: httpRespMessage,\n        };\n        if (httpRespMessage.statusCode < 200 || httpRespMessage.statusCode > 299) {\n            // Unknown error. Format according to ApiError standard.\n            parsedHttpRespMessage.err = new ApiError({\n                errors: new Array(),\n                code: httpRespMessage.statusCode,\n                message: httpRespMessage.statusMessage,\n                response: httpRespMessage,\n            });\n        }\n        return parsedHttpRespMessage;\n    }\n    /**\n     * Parse the response body from an HTTP request.\n     *\n     * @param {object} body - The response body.\n     * @return {object} parsedHttpRespMessage - The parsed response.\n     * @param {?error} parsedHttpRespMessage.err - An error detected.\n     * @param {object} parsedHttpRespMessage.body - The original body value provided\n     *     will try to be JSON.parse'd. If it's successful, the parsed value will\n     * be returned here, otherwise the original value and an error will be returned.\n     */\n    parseHttpRespBody(body) {\n        const parsedHttpRespBody = {\n            body,\n        };\n        if (typeof body === 'string') {\n            try {\n                parsedHttpRespBody.body = JSON.parse(body);\n            }\n            catch (err) {\n                parsedHttpRespBody.body = body;\n            }\n        }\n        if (parsedHttpRespBody.body && parsedHttpRespBody.body.error) {\n            // Error from JSON API.\n            parsedHttpRespBody.err = new ApiError(parsedHttpRespBody.body.error);\n        }\n        return parsedHttpRespBody;\n    }\n    /**\n     * Take a Duplexify stream, fetch an authenticated connection header, and\n     * create an outgoing writable stream.\n     *\n     * @param {Duplexify} dup - Duplexify stream.\n     * @param {object} options - Configuration object.\n     * @param {module:common/connection} options.connection - A connection instance used to get a token with and send the request through.\n     * @param {object} options.metadata - Metadata to send at the head of the request.\n     * @param {object} options.request - Request object, in the format of a standard Node.js http.request() object.\n     * @param {string=} options.request.method - Default: \"POST\".\n     * @param {string=} options.request.qs.uploadType - Default: \"multipart\".\n     * @param {string=} options.streamContentType - Default: \"application/octet-stream\".\n     * @param {function} onComplete - Callback, executed after the writable Request stream has completed.\n     */\n    makeWritableStream(dup, options, onComplete) {\n        onComplete = onComplete || util.noop;\n        const writeStream = new ProgressStream();\n        writeStream.on('progress', evt => dup.emit('progress', evt));\n        dup.setWritable(writeStream);\n        const defaultReqOpts = {\n            method: 'POST',\n            qs: {\n                uploadType: 'multipart',\n            },\n            timeout: 0,\n            maxRetries: 0,\n        };\n        const metadata = options.metadata || {};\n        const reqOpts = extend(true, defaultReqOpts, options.request, {\n            multipart: [\n                {\n                    'Content-Type': 'application/json',\n                    body: JSON.stringify(metadata),\n                },\n                {\n                    'Content-Type': metadata.contentType || 'application/octet-stream',\n                    body: writeStream,\n                },\n            ],\n        });\n        options.makeAuthenticatedRequest(reqOpts, {\n            onAuthenticated(err, authenticatedReqOpts) {\n                if (err) {\n                    dup.destroy(err);\n                    return;\n                }\n                const request = teeny_request_1.teenyRequest.defaults(requestDefaults);\n                request(authenticatedReqOpts, (err, resp, body) => {\n                    util.handleResp(err, resp, body, (err, data) => {\n                        if (err) {\n                            dup.destroy(err);\n                            return;\n                        }\n                        dup.emit('response', resp);\n                        onComplete(data);\n                    });\n                });\n            },\n        });\n    }\n    /**\n     * Returns true if the API request should be retried, given the error that was\n     * given the first time the request was attempted. This is used for rate limit\n     * related errors as well as intermittent server errors.\n     *\n     * @param {error} err - The API error to check if it is appropriate to retry.\n     * @return {boolean} True if the API request should be retried, false otherwise.\n     */\n    shouldRetryRequest(err) {\n        if (err) {\n            if ([408, 429, 500, 502, 503, 504].indexOf(err.code) !== -1) {\n                return true;\n            }\n            if (err.errors) {\n                for (const e of err.errors) {\n                    const reason = e.reason;\n                    if (reason === 'rateLimitExceeded') {\n                        return true;\n                    }\n                    if (reason === 'userRateLimitExceeded') {\n                        return true;\n                    }\n                    if (reason && reason.includes('EAI_AGAIN')) {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    }\n    /**\n     * Get a function for making authenticated requests.\n     *\n     * @param {object} config - Configuration object.\n     * @param {boolean=} config.autoRetry - Automatically retry requests if the\n     *     response is related to rate limits or certain intermittent server\n     * errors. We will exponentially backoff subsequent requests by default.\n     * (default: true)\n     * @param {object=} config.credentials - Credentials object.\n     * @param {boolean=} config.customEndpoint - If true, just return the provided request options. Default: false.\n     * @param {boolean=} config.useAuthWithCustomEndpoint - If true, will authenticate when using a custom endpoint. Default: false.\n     * @param {string=} config.email - Account email address, required for PEM/P12 usage.\n     * @param {number=} config.maxRetries - Maximum number of automatic retries attempted before returning the error. (default: 3)\n     * @param {string=} config.keyFile - Path to a .json, .pem, or .p12 keyfile.\n     * @param {array} config.scopes - Array of scopes required for the API.\n     */\n    makeAuthenticatedRequestFactory(config) {\n        const googleAutoAuthConfig = extend({}, config);\n        if (googleAutoAuthConfig.projectId === '{{projectId}}') {\n            delete googleAutoAuthConfig.projectId;\n        }\n        let authClient;\n        if (googleAutoAuthConfig.authClient instanceof google_auth_library_1.GoogleAuth) {\n            // Use an existing `GoogleAuth`\n            authClient = googleAutoAuthConfig.authClient;\n        }\n        else {\n            // Pass an `AuthClient` to `GoogleAuth`, if available\n            const config = {\n                ...googleAutoAuthConfig,\n                authClient: googleAutoAuthConfig.authClient,\n            };\n            authClient = new google_auth_library_1.GoogleAuth(config);\n        }\n        function makeAuthenticatedRequest(reqOpts, optionsOrCallback) {\n            let stream;\n            let projectId;\n            const reqConfig = extend({}, config);\n            let activeRequest_;\n            if (!optionsOrCallback) {\n                stream = duplexify();\n                reqConfig.stream = stream;\n            }\n            const options = typeof optionsOrCallback === 'object' ? optionsOrCallback : undefined;\n            const callback = typeof optionsOrCallback === 'function' ? optionsOrCallback : undefined;\n            const onAuthenticated = (err, authenticatedReqOpts) => {\n                const authLibraryError = err;\n                const autoAuthFailed = err &&\n                    err.message.indexOf('Could not load the default credentials') > -1;\n                if (autoAuthFailed) {\n                    // Even though authentication failed, the API might not actually\n                    // care.\n                    authenticatedReqOpts = reqOpts;\n                }\n                if (!err || autoAuthFailed) {\n                    try {\n                        authenticatedReqOpts = util.decorateRequest(authenticatedReqOpts, projectId);\n                        err = null;\n                    }\n                    catch (e) {\n                        // A projectId was required, but we don't have one.\n                        // Re-use the \"Could not load the default credentials error\" if\n                        // auto auth failed.\n                        err = err || e;\n                    }\n                }\n                if (err) {\n                    if (stream) {\n                        stream.destroy(err);\n                    }\n                    else {\n                        const fn = options && options.onAuthenticated\n                            ? options.onAuthenticated\n                            : callback;\n                        fn(err);\n                    }\n                    return;\n                }\n                if (options && options.onAuthenticated) {\n                    options.onAuthenticated(null, authenticatedReqOpts);\n                }\n                else {\n                    activeRequest_ = util.makeRequest(authenticatedReqOpts, reqConfig, (apiResponseError, ...params) => {\n                        if (apiResponseError &&\n                            apiResponseError.code === 401 &&\n                            authLibraryError) {\n                            // Re-use the \"Could not load the default credentials error\" if\n                            // the API request failed due to missing credentials.\n                            apiResponseError = authLibraryError;\n                        }\n                        callback(apiResponseError, ...params);\n                    });\n                }\n            };\n            Promise.all([\n                config.projectId && config.projectId !== '{{projectId}}'\n                    ? // The user provided a project ID. We don't need to check with the\n                        // auth client, it could be incorrect.\n                        new Promise(resolve => resolve(config.projectId))\n                    : authClient.getProjectId(),\n                reqConfig.customEndpoint && reqConfig.useAuthWithCustomEndpoint !== true\n                    ? // Using a custom API override. Do not use `google-auth-library` for\n                        // authentication. (ex: connecting to a local Datastore server)\n                        new Promise(resolve => resolve(reqOpts))\n                    : authClient.authorizeRequest(reqOpts),\n            ])\n                .then(([_projectId, authorizedReqOpts]) => {\n                projectId = _projectId;\n                onAuthenticated(null, authorizedReqOpts);\n            })\n                .catch(onAuthenticated);\n            if (stream) {\n                return stream;\n            }\n            return {\n                abort() {\n                    setImmediate(() => {\n                        if (activeRequest_) {\n                            activeRequest_.abort();\n                            activeRequest_ = null;\n                        }\n                    });\n                },\n            };\n        }\n        const mar = makeAuthenticatedRequest;\n        mar.getCredentials = authClient.getCredentials.bind(authClient);\n        mar.authClient = authClient;\n        return mar;\n    }\n    /**\n     * Make a request through the `retryRequest` module with built-in error\n     * handling and exponential back off.\n     *\n     * @param {object} reqOpts - Request options in the format `request` expects.\n     * @param {object=} config - Configuration object.\n     * @param {boolean=} config.autoRetry - Automatically retry requests if the\n     *     response is related to rate limits or certain intermittent server\n     * errors. We will exponentially backoff subsequent requests by default.\n     * (default: true)\n     * @param {number=} config.maxRetries - Maximum number of automatic retries\n     *     attempted before returning the error. (default: 3)\n     * @param {object=} config.request - HTTP module for request calls.\n     * @param {function} callback - The callback function.\n     */\n    makeRequest(reqOpts, config, callback) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        let autoRetryValue = AUTO_RETRY_DEFAULT;\n        if (config.autoRetry !== undefined &&\n            ((_a = config.retryOptions) === null || _a === void 0 ? void 0 : _a.autoRetry) !== undefined) {\n            throw new ApiError('autoRetry is deprecated. Use retryOptions.autoRetry instead.');\n        }\n        else if (config.autoRetry !== undefined) {\n            autoRetryValue = config.autoRetry;\n        }\n        else if (((_b = config.retryOptions) === null || _b === void 0 ? void 0 : _b.autoRetry) !== undefined) {\n            autoRetryValue = config.retryOptions.autoRetry;\n        }\n        let maxRetryValue = MAX_RETRY_DEFAULT;\n        if (config.maxRetries && ((_c = config.retryOptions) === null || _c === void 0 ? void 0 : _c.maxRetries)) {\n            throw new ApiError('maxRetries is deprecated. Use retryOptions.maxRetries instead.');\n        }\n        else if (config.maxRetries) {\n            maxRetryValue = config.maxRetries;\n        }\n        else if ((_d = config.retryOptions) === null || _d === void 0 ? void 0 : _d.maxRetries) {\n            maxRetryValue = config.retryOptions.maxRetries;\n        }\n        const options = {\n            request: teeny_request_1.teenyRequest.defaults(requestDefaults),\n            retries: autoRetryValue !== false ? maxRetryValue : 0,\n            noResponseRetries: autoRetryValue !== false ? maxRetryValue : 0,\n            shouldRetryFn(httpRespMessage) {\n                var _a, _b;\n                const err = util.parseHttpRespMessage(httpRespMessage).err;\n                if ((_a = config.retryOptions) === null || _a === void 0 ? void 0 : _a.retryableErrorFn) {\n                    return err && ((_b = config.retryOptions) === null || _b === void 0 ? void 0 : _b.retryableErrorFn(err));\n                }\n                return err && util.shouldRetryRequest(err);\n            },\n            maxRetryDelay: (_e = config.retryOptions) === null || _e === void 0 ? void 0 : _e.maxRetryDelay,\n            retryDelayMultiplier: (_f = config.retryOptions) === null || _f === void 0 ? void 0 : _f.retryDelayMultiplier,\n            totalTimeout: (_g = config.retryOptions) === null || _g === void 0 ? void 0 : _g.totalTimeout,\n        };\n        if (typeof reqOpts.maxRetries === 'number') {\n            options.retries = reqOpts.maxRetries;\n        }\n        if (!config.stream) {\n            return retryRequest(reqOpts, options, (err, response, body) => {\n                util.handleResp(err, response, body, callback);\n            });\n        }\n        const dup = config.stream;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        let requestStream;\n        const isGetRequest = (reqOpts.method || 'GET').toUpperCase() === 'GET';\n        if (isGetRequest) {\n            requestStream = retryRequest(reqOpts, options);\n            dup.setReadable(requestStream);\n        }\n        else {\n            // Streaming writable HTTP requests cannot be retried.\n            requestStream = options.request(reqOpts);\n            dup.setWritable(requestStream);\n        }\n        // Replay the Request events back to the stream.\n        requestStream\n            .on('error', dup.destroy.bind(dup))\n            .on('response', dup.emit.bind(dup, 'response'))\n            .on('complete', dup.emit.bind(dup, 'complete'));\n        dup.abort = requestStream.abort;\n        return dup;\n    }\n    /**\n     * Decorate the options about to be made in a request.\n     *\n     * @param {object} reqOpts - The options to be passed to `request`.\n     * @param {string} projectId - The project ID.\n     * @return {object} reqOpts - The decorated reqOpts.\n     */\n    decorateRequest(reqOpts, projectId) {\n        delete reqOpts.autoPaginate;\n        delete reqOpts.autoPaginateVal;\n        delete reqOpts.objectMode;\n        if (reqOpts.qs !== null && typeof reqOpts.qs === 'object') {\n            delete reqOpts.qs.autoPaginate;\n            delete reqOpts.qs.autoPaginateVal;\n            reqOpts.qs = projectify_1.replaceProjectIdToken(reqOpts.qs, projectId);\n        }\n        if (Array.isArray(reqOpts.multipart)) {\n            reqOpts.multipart = reqOpts.multipart.map(part => {\n                return projectify_1.replaceProjectIdToken(part, projectId);\n            });\n        }\n        if (reqOpts.json !== null && typeof reqOpts.json === 'object') {\n            delete reqOpts.json.autoPaginate;\n            delete reqOpts.json.autoPaginateVal;\n            reqOpts.json = projectify_1.replaceProjectIdToken(reqOpts.json, projectId);\n        }\n        reqOpts.uri = projectify_1.replaceProjectIdToken(reqOpts.uri, projectId);\n        return reqOpts;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    isCustomType(unknown, module) {\n        function getConstructorName(obj) {\n            return obj.constructor && obj.constructor.name.toLowerCase();\n        }\n        const moduleNameParts = module.split('/');\n        const parentModuleName = moduleNameParts[0] && moduleNameParts[0].toLowerCase();\n        const subModuleName = moduleNameParts[1] && moduleNameParts[1].toLowerCase();\n        if (subModuleName && getConstructorName(unknown) !== subModuleName) {\n            return false;\n        }\n        let walkingModule = unknown;\n        // eslint-disable-next-line no-constant-condition\n        while (true) {\n            if (getConstructorName(walkingModule) === parentModuleName) {\n                return true;\n            }\n            walkingModule = walkingModule.parent;\n            if (!walkingModule) {\n                return false;\n            }\n        }\n    }\n    /**\n     * Create a properly-formatted User-Agent string from a package.json file.\n     *\n     * @param {object} packageJson - A module's package.json file.\n     * @return {string} userAgent - The formatted User-Agent string.\n     */\n    getUserAgentFromPackageJson(packageJson) {\n        const hyphenatedPackageName = packageJson.name\n            .replace('@google-cloud', 'gcloud-node') // For legacy purposes.\n            .replace('/', '-'); // For UA spec-compliance purposes.\n        return hyphenatedPackageName + '/' + packageJson.version;\n    }\n    /**\n     * Given two parameters, figure out if this is either:\n     *  - Just a callback function\n     *  - An options object, and then a callback function\n     * @param optionsOrCallback An options object or callback.\n     * @param cb A potentially undefined callback.\n     */\n    maybeOptionsOrCallback(optionsOrCallback, cb) {\n        return typeof optionsOrCallback === 'function'\n            ? [{}, optionsOrCallback]\n            : [optionsOrCallback, cb];\n    }\n}\nexports.Util = Util;\n/**\n * Basic Passthrough Stream that records the number of bytes read\n * every time the cursor is moved.\n */\nclass ProgressStream extends stream_1.Transform {\n    constructor() {\n        super(...arguments);\n        this.bytesRead = 0;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    _transform(chunk, encoding, callback) {\n        this.bytesRead += chunk.length;\n        this.emit('progress', { bytesWritten: this.bytesRead, contentLength: '*' });\n        this.push(chunk);\n        callback();\n    }\n}\nconst util = new Util();\nexports.util = util;\n//# sourceMappingURL=util.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}